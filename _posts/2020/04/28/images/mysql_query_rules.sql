PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE mysql_query_rules (rule_id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL , active INT CHECK (active IN (0,1)) NOT NULL DEFAULT 0 , username VARCHAR , schemaname VARCHAR , flagIN INT CHECK (flagIN >= 0) NOT NULL DEFAULT 0 , client_addr VARCHAR , proxy_addr VARCHAR , proxy_port INT CHECK (proxy_port >= 0 AND proxy_port <= 65535), digest VARCHAR , match_digest VARCHAR , match_pattern VARCHAR , negate_match_pattern INT CHECK (negate_match_pattern IN (0,1)) NOT NULL DEFAULT 0 , re_modifiers VARCHAR DEFAULT 'CASELESS' , flagOUT INT CHECK (flagOUT >= 0), replace_pattern VARCHAR CHECK(CASE WHEN replace_pattern IS NULL THEN 1 WHEN replace_pattern IS NOT NULL AND match_pattern IS NOT NULL THEN 1 ELSE 0 END) , destination_hostgroup INT DEFAULT NULL , cache_ttl INT CHECK(cache_ttl > 0) , cache_empty_result INT CHECK (cache_empty_result IN (0,1)) DEFAULT NULL , cache_timeout INT CHECK(cache_timeout >= 0) , reconnect INT CHECK (reconnect IN (0,1)) DEFAULT NULL , timeout INT UNSIGNED CHECK (timeout >= 0) , retries INT CHECK (retries>=0 AND retries <=1000) , delay INT UNSIGNED CHECK (delay >=0) , next_query_flagIN INT UNSIGNED , mirror_flagOUT INT UNSIGNED , mirror_hostgroup INT UNSIGNED , error_msg VARCHAR , OK_msg VARCHAR , sticky_conn INT CHECK (sticky_conn IN (0,1)) , multiplex INT CHECK (multiplex IN (0,1,2)) , gtid_from_hostgroup INT UNSIGNED , log INT CHECK (log IN (0,1)) , apply INT CHECK(apply IN (0,1)) NOT NULL DEFAULT 0 , comment VARCHAR);
INSERT INTO "mysql_query_rules" VALUES(1,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^SELECT \* ',0,'CASELESS',0,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'对不起，您的操作被禁止.保护公司数据安全人人有责!!!',NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(2,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^UPDATE.*',0,'CASELESS',0,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'对不起，您的操作被禁止.保护公司数据安全人人有责!!!',NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(3,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^DELETE.*',0,'CASELESS',0,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'对不起，您的操作被禁止.保护公司数据安全人人有责!!!',NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(4,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^INSERT.*',0,'CASELESS',0,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'对不起，您的操作被禁止.保护公司数据安全人人有责!!!',NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(5,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^TRUNCATE.*',0,'CASELESS',0,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'对不起，您的操作被禁止.保护公司数据安全人人有责!!!',NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(6,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^ALTER.*',0,'CASELESS',0,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'对不起，您的操作被禁止.保护公司数据安全人人有责!!!',NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(7,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^DROP.*',0,'CASELESS',0,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'对不起，您的操作被禁止.保护公司数据安全人人有责!!!',NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(8,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^SHOW.*',0,'CASELESS',0,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'对不起，您的操作被禁止.保护公司数据安全人人有责!!!',NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(9,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^SET.*',0,'CASELESS',0,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'对不起，您的操作被禁止.保护公司数据安全人人有责!!!',NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(10,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'(.*) JOIN (.*)',0,'CASELESS',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'对不起，您的操作被禁止.保护公司数据安全人人有责!!!',NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(11,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'(.*) LIKE (.*)',0,'CASELESS',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'对不起，您的操作被禁止.保护公司数据安全人人有责!!!',NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(12,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^CREATE.*',0,'CASELESS',0,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'对不起，您的操作被禁止.保护公司数据安全人人有责!!!',NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(21,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^SELECT ((.*),mphone|mphone,(.*)|(.*),mphone,(.*)|mphone|(.*),email|email,(.*)|(.*),email,(.*)|email) (.*)',1,'CASELESS',100,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,NULL);
INSERT INTO "mysql_query_rules" VALUES(50,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^SELECT (.*),mphone (.*)',0,'CASELESS',1,'SELECT \1,concat(mphone,''@111'') as mphone \2',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,NULL);
INSERT INTO "mysql_query_rules" VALUES(51,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^SELECT mphone,(.*) (.*)',0,'CASELESS',1,'SELECT concat(mphone,''@222'') as mphone,\1 \2',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,NULL);
INSERT INTO "mysql_query_rules" VALUES(52,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^SELECT (.*),mphone,(.*) (.*)',0,'CASELESS',1,'SELECT \1,concat(mphone,''@333'') as mphone,\2 \3',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,NULL);
INSERT INTO "mysql_query_rules" VALUES(53,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^SELECT mphone (.*)',0,'CASELESS',1,'SELECT concat(mphone,''@444'') as mphone \1',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,NULL);
INSERT INTO "mysql_query_rules" VALUES(54,1,NULL,NULL,1,NULL,NULL,NULL,NULL,NULL,'^SELECT ((.*),email|email,(.*)|(.*),email,(.*)|email) (.*)',1,'CASELESS',100,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,NULL);
INSERT INTO "mysql_query_rules" VALUES(55,1,NULL,NULL,1,NULL,NULL,NULL,NULL,NULL,'^SELECT ((.*),email|email,(.*)|(.*),email,(.*)|email) (.*)',0,'CASELESS',2,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,NULL);
INSERT INTO "mysql_query_rules" VALUES(56,1,NULL,NULL,2,NULL,NULL,NULL,NULL,NULL,'^SELECT (.*),email,(.*) (.*)',0,'CASELESS',100,'SELECT \1,concat(email,''@333'') as email,\2 \3',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,NULL);
INSERT INTO "mysql_query_rules" VALUES(57,1,NULL,NULL,2,NULL,NULL,NULL,NULL,NULL,'^SELECT email (.*)',0,'CASELESS',100,'SELECT concat(email,''@444'') as email \1',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,NULL);
INSERT INTO "mysql_query_rules" VALUES(58,1,NULL,NULL,2,NULL,NULL,NULL,NULL,NULL,'^SELECT (.*),email (.*)',0,'CASELESS',100,'SELECT \1,concat(email,''@111'') as email \2',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,NULL);
INSERT INTO "mysql_query_rules" VALUES(59,1,NULL,NULL,2,NULL,NULL,NULL,NULL,NULL,'^SELECT email,(.*) (.*)',0,'CASELESS',100,'SELECT concat(email,''@222'') as email,\1 \2',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,NULL);
INSERT INTO "mysql_query_rules" VALUES(60,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^SELECT (.*),email,(.*) (.*)',0,'CASELESS',0,'SELECT \1,concat(email,''@333'') as email,\2 \3',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(61,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^SELECT email (.*)',0,'CASELESS',0,'SELECT concat(email,''@444'') as email \1',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(62,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^SELECT (.*),email (.*)',0,'CASELESS',0,'SELECT \1,concat(email,''@111'') as email \2',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(63,1,NULL,NULL,0,NULL,NULL,NULL,NULL,NULL,'^SELECT email,(.*) (.*)',0,'CASELESS',0,'SELECT concat(email,''@222'') as email,\1 \2',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,NULL);
INSERT INTO "mysql_query_rules" VALUES(100,1,NULL,NULL,100,NULL,NULL,NULL,NULL,NULL,'^SELECT (.*) (.*)',0,'CASELESS',100,'SELECT \1 \2 LIMIT 10',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,1,NULL);
COMMIT;
